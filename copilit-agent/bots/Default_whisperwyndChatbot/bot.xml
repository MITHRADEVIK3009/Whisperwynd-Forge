<bot schemaname="Default_whisperwyndChatbot" version="1.0.0">
  <!-- 
    Whisperwynd Bot Configuration
    - Handles story generator chatbot authentication
    - Trigger mode: 1 (auto-on launch)
    - Auth mode: 2 (OAuth2)
    Contribution: Added metadata, externalized auth, improved icon reference
  -->
  <metadata>
    <name>Whisperwynd Story Generator Bot</name>
    <description>A conversational agent for interactive story world-building.</description>
    <author>Mithradevi K</author>
    <maintainer>Whisperwynd Dev Team</maintainer>
  </metadata>

  <!-- Authentication (externalized to environment variables for security) -->
  <authenticationconfiguration>
    {
      "$kind":"BotAuthenticationConfiguration",
      "clientId":"${BOT_CLIENT_ID}",
      "clientSecret":"${BOT_CLIENT_SECRET}"
    }
  </authenticationconfiguration>

  <authenticationmode>2</authenticationmode>
  <authenticationtrigger>1</authenticationtrigger>

  <!-- Icon reference instead of large inline Base64 -->
  <icon path="./assets/whisperwynd_icon.png" />
<iscustomizable>0</iscustomizable>
  <language>1033</language>
  <name>Whisperwynd Story Generator</name>
  <runtimeprovider>0</runtimeprovider>

  <synchronizationstatus>{
  "$kind": "BotSynchronizationDetails",
  "contentVersion": 2,
  "lastFinishedPublishOperation": {
    "$kind": "PublishResultDetails",
    "diagnosticDetails": [
      {
        "$kind": "ActionReferenceDiagnosticResult",
        "diagnosticList": [
          {
            "$kind": "AdaptiveCardError",
            "errorCode": "AdaptiveCardMissingActionSubmit"
          }
        ],
        "componentId": "516c5835-94be-427b-8bba-0c9056def38b",
        "reference": {
          "dialogId": "Default_whisperwyndChatbot.topic.AC2",
          "triggerId": "main",
          "actionId": "main"
        }
      },
      {
        "$kind": "ActionReferenceDiagnosticResult",
        "diagnosticList": [
          {
            "$kind": "PropertyError",
            "propertyName": "Card",
            "errorCode": "MissingRequiredProperty"
          },
          {
            "$kind": "PropertyError",
            "propertyName": "Output",
            "errorCode": "MissingRequiredProperty"
          },
          {
            "$kind": "PropertyError",
            "propertyName": "OutputType",
            "errorCode": "MissingRequiredProperty"
          }
        ],
        "componentId": "8e25a3b0-1b1b-485f-b685-cddff037396d",
        "reference": {
          "dialogId": "Default_whisperwyndChatbot.topic.AddAC3",
          "triggerId": "main",
          "actionId": "main"
        }
      }
    ],
    "userId": "1ebbcf5f-b29d-4fbc-b8ec-6046cbea5ea0",
    "operationEnd": "2025-04-28T20:34:09.321536Z",
    "status": "Failed"
  },
  "lastPublishedDetails": {
    "$kind": "SuccessfulPublishResultDetails"
  },
  "currentSynchronizationState": {
    "$kind": "SynchronizationState",
    "botRegistration": {
      "$kind": "BotRegistrationDetails",
      "botRegistrationIdConsumptionTime": "2025-04-06T18:05:23Z",
      "applicationId": "16874ca0-d946-46d0-8ba5-b89d604b02c6",
      "isAppAvailableInTenant": true
    },
    "provisioningStatus": "Provisioned",
    "state": "Synchronized"
  },
  "lastSynchronizedOnUtc": "2025-04-28T20:34:15.4165404Z"
}</synchronizationstatus>
  <template>websiteqna-1.0.0</template>
  <timezoneruleversionnumber>4</timezoneruleversionnumber>
</bot>
